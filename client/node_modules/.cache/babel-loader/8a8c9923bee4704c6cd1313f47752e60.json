{"ast":null,"code":"var _jsxFileName = \"/Users/tanjain/MY/Learning/bookmyshow-app/client/src/BookTicket/BookTicket.container.js\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport BookTicketComponent from \"./BookTicket.component.jsx\";\nimport config from \"../config.json\";\nimport history from \"../history\";\n\nclass BookTicket extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      maxSeatBookingCount: 1,\n      bookedSeats: [],\n      seatLayout: [],\n      showError: false\n    };\n    this.bookTicketClickHandler = this.bookTicketClickHandler.bind(this);\n    this.singleSeatClickHandler = this.singleSeatClickHandler.bind(this);\n    this.bookingSeatCountChangeHandler = this.bookingSeatCountChangeHandler.bind(this);\n    console.log(\"BookTicket-container: constructor\");\n  }\n\n  componentDidMount() {\n    let seatLayouttemp = [];\n    let rowName = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\"];\n\n    if (Object.keys(this.props.selectedEventDetails).length > 0) {\n      const selectedEventDetails = this.props.selectedEventDetails;\n\n      for (let row = 0; row < selectedEventDetails.hall.total_rows; row++) {\n        for (let column = 1; column < selectedEventDetails.hall.total_columns; column++) {\n          seatLayouttemp.push(\"\".concat(rowName[row]).concat(column));\n        }\n\n        seatLayouttemp.push(\"\");\n      }\n\n      selectedEventDetails.booked_seat.forEach(seat => seatLayouttemp.forEach((teamSeat, index) => {\n        if (seat === teamSeat) {\n          seatLayouttemp[index] = \"\".concat(teamSeat, \":booked\");\n        }\n      }));\n      this.setState({\n        seatLayout: seatLayouttemp\n      });\n    }\n  }\n\n  bookingSeatCountChangeHandler(event) {\n    this.setState({\n      maxSeatBookingCount: event.target.value\n    });\n  }\n\n  bookTicketClickHandler() {\n    //console.log(this.state.bookedSeats);\n    try {\n      fetch(\"\".concat(config.apiUrl, \"/api/events/shows/\").concat(this.props.selectedEventDetails.show_id), {\n        method: \"PATCH\",\n        body: JSON.stringify({\n          booked_seat: this.state.bookedSeats\n        }),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(response => response.json()).then(response => {\n        //console.log(response);\n        if (response.status_code === 200) {\n          history.push(\"/thanks\");\n        }\n      });\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  singleSeatClickHandler(event) {\n    const seat = event.target.value;\n\n    if (this.state.bookedSeats.length < this.state.maxSeatBookingCount) {\n      event.currentTarget.classList.add(\"selected\");\n      let tempArry = this.state.seatLayout;\n      tempArry[tempArry.map((x, i) => [i, x]).filter(x => x[1] === seat)[0][0]] = \"\".concat(seat, \":booked\");\n      this.setState({\n        seatLayout: [...tempArry]\n      });\n      this.setState(previousState => ({\n        bookedSeats: [...previousState.bookedSeats, seat]\n      }));\n    } else if (this.state.bookedSeats.length === this.state.maxSeatBookingCount) {\n      this.setState({\n        showError: true\n      });\n    }\n  }\n\n  render() {\n    console.log(\"bookTicket:render\");\n    let selectedEventDetailsDefaultValue = {\n      show_date: \"\",\n      show_time: \"\",\n      booked_seat: [],\n      hall: {\n        total_rows: 0,\n        total_columns: 0\n      }\n    };\n    let selectedEventDetails = this.props.selectedEventDetails; //console.log(selectedEventDetails);\n\n    selectedEventDetails = Object.keys(selectedEventDetails).length === 0 ? selectedEventDetailsDefaultValue : selectedEventDetails;\n    return React.createElement(BookTicketComponent, {\n      totalRows: selectedEventDetails.hall.total_rows,\n      totalColumns: selectedEventDetails.hall.total_columns,\n      showDate: selectedEventDetails.show_date,\n      showTime: selectedEventDetails.show_time,\n      seatLayout: this.state.seatLayout,\n      bookingSeatCountChangeHandler: this.bookingSeatCountChangeHandler,\n      bookTicketClickHandler: this.bookTicketClickHandler,\n      singleSeatClickHandler: this.singleSeatClickHandler,\n      showError: this.state.showError,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    });\n  }\n\n}\n\nBookTicket.defaultProps = {};\nBookTicket.propTypes = {\n  selectedEventDetails: PropTypes.shape({\n    show_date: PropTypes.string,\n    show_time: PropTypes.string,\n    booked_seat: PropTypes.arrayOf(PropTypes.string),\n    hall: PropTypes.shape({\n      total_rows: PropTypes.number,\n      total_columns: PropTypes.number\n    })\n  })\n};\nexport default BookTicket;","map":{"version":3,"sources":["/Users/tanjain/MY/Learning/bookmyshow-app/client/src/BookTicket/BookTicket.container.js"],"names":["React","Component","PropTypes","BookTicketComponent","config","history","BookTicket","constructor","props","state","maxSeatBookingCount","bookedSeats","seatLayout","showError","bookTicketClickHandler","bind","singleSeatClickHandler","bookingSeatCountChangeHandler","console","log","componentDidMount","seatLayouttemp","rowName","Object","keys","selectedEventDetails","length","row","hall","total_rows","column","total_columns","push","booked_seat","forEach","seat","teamSeat","index","setState","event","target","value","fetch","apiUrl","show_id","method","body","JSON","stringify","headers","then","response","json","status_code","err","currentTarget","classList","add","tempArry","map","x","i","filter","previousState","render","selectedEventDetailsDefaultValue","show_date","show_time","defaultProps","propTypes","shape","string","arrayOf","number"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport BookTicketComponent from \"./BookTicket.component.jsx\";\n\nimport config from \"../config.json\";\n\nimport history from \"../history\";\n\nclass BookTicket extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      maxSeatBookingCount: 1,\n      bookedSeats: [],\n      seatLayout: [],\n      showError: false\n    };\n    this.bookTicketClickHandler = this.bookTicketClickHandler.bind(this);\n    this.singleSeatClickHandler = this.singleSeatClickHandler.bind(this);\n    this.bookingSeatCountChangeHandler = this.bookingSeatCountChangeHandler.bind(\n      this\n    );\n    console.log(\"BookTicket-container: constructor\");\n  }\n\n  componentDidMount() {\n    let seatLayouttemp = [];\n    let rowName = [\n      \"A\",\n      \"B\",\n      \"C\",\n      \"D\",\n      \"E\",\n      \"F\",\n      \"G\",\n      \"H\",\n      \"I\",\n      \"J\",\n      \"K\",\n      \"L\",\n      \"M\",\n      \"N\",\n      \"O\",\n      \"P\",\n      \"Q\",\n      \"R\",\n      \"S\",\n      \"T\",\n      \"U\",\n      \"V\",\n      \"W\",\n      \"X\",\n      \"Y\",\n      \"Z\"\n    ];\n    if (Object.keys(this.props.selectedEventDetails).length > 0) {\n      const { selectedEventDetails } = this.props;\n      for (let row = 0; row < selectedEventDetails.hall.total_rows; row++) {\n        for (\n          let column = 1;\n          column < selectedEventDetails.hall.total_columns;\n          column++\n        ) {\n          seatLayouttemp.push(`${rowName[row]}${column}`);\n        }\n        seatLayouttemp.push(\"\");\n      }\n\n      selectedEventDetails.booked_seat.forEach(seat =>\n        seatLayouttemp.forEach((teamSeat, index) => {\n          if (seat === teamSeat) {\n            seatLayouttemp[index] = `${teamSeat}:booked`;\n          }\n        })\n      );\n\n      this.setState({ seatLayout: seatLayouttemp });\n    }\n  }\n\n  bookingSeatCountChangeHandler(event) {\n    this.setState({\n      maxSeatBookingCount: event.target.value\n    });\n  }\n\n  bookTicketClickHandler() {\n    //console.log(this.state.bookedSeats);\n    try {\n      fetch(\n        `${config.apiUrl}/api/events/shows/${this.props.selectedEventDetails.show_id}`,\n        {\n          method: \"PATCH\",\n          body: JSON.stringify({ booked_seat: this.state.bookedSeats }),\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }\n      )\n        .then(response => response.json())\n        .then(response => {\n          //console.log(response);\n          if (response.status_code === 200) {\n            history.push(\"/thanks\");\n          }\n        });\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  singleSeatClickHandler(event) {\n    const seat = event.target.value;\n    if (this.state.bookedSeats.length < this.state.maxSeatBookingCount) {\n      event.currentTarget.classList.add(\"selected\");\n\n      let tempArry = this.state.seatLayout;\n\n      tempArry[\n        tempArry.map((x, i) => [i, x]).filter(x => x[1] === seat)[0][0]\n      ] = `${seat}:booked`;\n\n      this.setState({\n        seatLayout: [...tempArry]\n      });\n\n      this.setState(previousState => ({\n        bookedSeats: [...previousState.bookedSeats, seat]\n      }));\n    } else if (\n      this.state.bookedSeats.length === this.state.maxSeatBookingCount\n    ) {\n      this.setState({\n        showError: true\n      });\n    }\n  }\n\n  render() {\n    console.log(\"bookTicket:render\");\n    let selectedEventDetailsDefaultValue = {\n      show_date: \"\",\n      show_time: \"\",\n      booked_seat: [],\n      hall: { total_rows: 0, total_columns: 0 }\n    };\n\n    let { selectedEventDetails } = this.props;\n    //console.log(selectedEventDetails);\n\n    selectedEventDetails =\n      Object.keys(selectedEventDetails).length === 0\n        ? selectedEventDetailsDefaultValue\n        : selectedEventDetails;\n\n    return (\n      <BookTicketComponent\n        totalRows={selectedEventDetails.hall.total_rows}\n        totalColumns={selectedEventDetails.hall.total_columns}\n        showDate={selectedEventDetails.show_date}\n        showTime={selectedEventDetails.show_time}\n        seatLayout={this.state.seatLayout}\n        bookingSeatCountChangeHandler={this.bookingSeatCountChangeHandler}\n        bookTicketClickHandler={this.bookTicketClickHandler}\n        singleSeatClickHandler={this.singleSeatClickHandler}\n        showError={this.state.showError}\n      />\n    );\n  }\n}\n\nBookTicket.defaultProps = {};\n\nBookTicket.propTypes = {\n  selectedEventDetails: PropTypes.shape({\n    show_date: PropTypes.string,\n    show_time: PropTypes.string,\n    booked_seat: PropTypes.arrayOf(PropTypes.string),\n    hall: PropTypes.shape({\n      total_rows: PropTypes.number,\n      total_columns: PropTypes.number\n    })\n  })\n};\nexport default BookTicket;\n"]},"metadata":{},"sourceType":"module"}